                         
						 Tc2.0编写俄罗斯方块游戏(6)

作者：陈畅
联系地址：上海财经大学图书馆
电子邮件：shchenchang@gmail.com
个人主页：http://shchenchang.spaces.live.com
QQ:7019717（欢迎编程爱好者加我为好友）


关于俄罗斯方块程序的一些问题：
******************************************************
Tc2.0中怎么样设置图形显示？
Tc2.0中常用图形函数的用法？
怎样获取I盘输入？
怎样控制方块的移动？
怎样控制时间间隔(用于游戏中控制形状的下落)？
游戏中的各种形状及整个游戏空间怎么用数据表示？
游戏中怎么判断左右及向下移动的可能性？
游戏中怎么判断某一形状旋转的可能性？
按向下方向键时加速某一形状下落速度的处理？
怎么判断某一形状已经到底？
怎么判断某一已经被填满？
怎么消去已经被填满的一行？
怎么消去某一形状落到底后能够消去的所有的行？(如长条最多可以消去四行)
怎样修改游戏板的状态？
怎样统计分数？
怎样处理升级后的加速问题？
怎样判断游戏结束？
关于计分板设计的问题。
关于“下一个”形状取法的问题。
剩下的问题。

******************************************************
新的问题：
我想有一个最高记录的显示，应该怎么做呀？
我想实现一个进度存储功能，应该怎么做呀？




按向下方向键时加速某一形状下落速度的处理？

正常情况下，当前形状是在间隔时间到了之后自动下落一格。有时候，想让当前形状加速下
落，应该怎么
做呢？来看看看下面这段代码吧。


				fAccel=False;
				switch(key)
				{

				……
				
				case VK_DOWN: /* accelerate the speed of moving 
down */
					fAccel=True; /* 标志按下了向下键 */
					break;

				……

				}

				……
				
				
				/* 如果按下了向下键或间隔时间到，下落一格 */
				if (fAccel||TimerCounter> (20-speed*2) )
				{
					fAccel=False; /* 清除按下了向下键标志 */
					
					/* reset timer counter */
					TimerCounter=0;

					if (Moveable(CurShape,sx,sy,Down))
						Move(CurShape,&sx,&sy,Down);
					else /* 当前形状CurShape已经落到底了 */
					{
						
						
DrawShape(CurShape,sx,sy,FORECOL
OR);

						……

					}
				}

顺便说一下时间间隔到的标志：TimerCounter> (20-speed*2)。
TimerCounter由时钟中断控制，每秒种约增加18。(20-speed*2)为时间间隔。speed初值为0
，升级后speed加1。这样形状下落的时间间隔会越来越短。当speed为0时，形状下落的时间
间隔为20/18秒；当speed为9时，形状下落的时间间隔为2/18秒。当speed大于等于10的时候
，时间间隔为0。这时形状会不停地向下落，很难玩的哦^_^。
时间间隔到的时候，就触发当前形状的下落动作，同时计时变量重置为0，一直等到下一次
达到时间间隔到的时候。




怎么判断某一形状已经到底？

当当前形状准备向下移的时候，发现不能向下移动的时候，当前形状就落到底了。


					if (Moveable(CurShape,sx,sy,Down))
						Move(CurShape,&sx,&sy,Down);
					else /* 当前形状CurShape已经落到底了 */
					{
						
						
DrawShape(CurShape,sx,sy,FORECOL
OR);

						……

					}


这时候有很多事情要做。首先判断是不是有哪一行被填满，如果有则要消去这些填满的行。
同时要根据消去的行数计算得分。如果分数等于或超过了升级要达到的分数，则要升级游戏
难度，提高游戏速度。如果达到了游戏结束的条件，则要Game Over。^_^

